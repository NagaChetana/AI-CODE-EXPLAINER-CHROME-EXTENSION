<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Export SVG Icons to PNG</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Inter, system-ui, Arial, sans-serif; background:#f6f8fb; color:#0b1220; padding:20px; }
    .wrap { display:flex; gap:20px; align-items:flex-start; flex-wrap:wrap; }
    .card { background:#fff; border-radius:10px; padding:14px; box-shadow:0 6px 18px rgba(10,20,40,0.06); width:200px; text-align:center; }
    svg { background:#0b1220; border-radius:8px; padding:8px; display:block; margin: 0 auto 12px; }
    button { padding:8px 12px; border-radius:8px; border:0; background:#4f93ff; color:white; cursor:pointer; }
    .muted { color:#6b7280; font-size:13px; margin-top:8px; display:block; }
    header { margin-bottom:18px; }
  </style>
</head>
<body>
  <header>
    <h2>SVG → PNG Icon Exporter</h2>
    <p class="muted">Open this file locally, then click download to get PNG files for your Chrome extension icons.</p>
  </header>

  <div class="wrap">
    <div class="card">
      <!-- icon16 SVG (renders at 16px but scaled for visibility) -->
      <div>
        <svg id="svg16" xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24">
          <rect width="24" height="24" rx="4" fill="#0b1220"/>
          <text x="12" y="16" font-size="12" font-family="Arial" text-anchor="middle" fill="#4f93ff">AI</text>
        </svg>
      </div>
      <div style="margin-top:6px"><strong>16×16</strong></div>
      <div style="margin-top:10px">
        <button onclick="downloadPNG('svg16', 16, 16, 'icon16.png')">Download PNG</button>
      </div>
    </div>

    <div class="card">
      <!-- icon48 SVG -->
      <div>
        <svg id="svg48" xmlns="http://www.w3.org/2000/svg" width="96" height="96" viewBox="0 0 24 24">
          <rect width="24" height="24" rx="4" fill="#0b1220"/>
          <text x="12" y="16" font-size="12" font-family="Arial" text-anchor="middle" fill="#4f93ff">AI</text>
        </svg>
      </div>
      <div style="margin-top:6px"><strong>48×48</strong></div>
      <div style="margin-top:10px">
        <button onclick="downloadPNG('svg48', 48, 48, 'icon48.png')">Download PNG</button>
      </div>
    </div>

    <div class="card">
      <!-- icon128 SVG -->
      <div>
        <svg id="svg128" xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 24 24">
          <rect width="24" height="24" rx="4" fill="#0b1220"/>
          <text x="12" y="16" font-size="12" font-family="Arial" text-anchor="middle" fill="#4f93ff">AI</text>
        </svg>
      </div>
      <div style="margin-top:6px"><strong>128×128</strong></div>
      <div style="margin-top:10px">
        <button onclick="downloadPNG('svg128', 128, 128, 'icon128.png')">Download PNG</button>
      </div>
    </div>
  </div>

  <div style="margin-top:18px">
    <button onclick="downloadAll()">Download All PNGs</button>
  </div>

  <script>
    // Convert an inline SVG element to PNG and trigger download
    async function downloadPNG(svgId, width, height, filename) {
      const svgEl = document.getElementById(svgId);
      if (!svgEl) return alert('SVG not found: ' + svgId);

      // Clone SVG to avoid modifying original and set proper size/viewBox
      const clone = svgEl.cloneNode(true);
      // Ensure SVG has viewBox; if not, add one from width/height attributes
      if (!clone.getAttribute('viewBox')) {
        const w = clone.getAttribute('width') || width;
        const h = clone.getAttribute('height') || height;
        clone.setAttribute('viewBox', `0 0 ${w} ${h}`);
      }
      clone.setAttribute('width', width);
      clone.setAttribute('height', height);

      // Serialize
      const serializer = new XMLSerializer();
      let svgString = serializer.serializeToString(clone);

      // Add XML namespace if missing (helps some browsers)
      if (!svgString.match(/^<svg[^>]+xmlns="/)) {
        svgString = svgString.replace(/^<svg/, '<svg xmlns="http://www.w3.org/2000/svg"');
      }

      const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });
      const url = URL.createObjectURL(svgBlob);

      const img = new Image();
      // Some browsers require taint-free images; since it's local blob it's fine.
      img.onload = () => {
        // Create canvas at desired size
        const canvas = document.createElement('canvas');
        canvas.width = width;
        canvas.height = height;
        const ctx = canvas.getContext('2d');

        // Clear and draw white background if you want (icons typically need transparent bg, so skip)
        // ctx.fillStyle = 'white';
        // ctx.fillRect(0,0,canvas.width,canvas.height);

        ctx.drawImage(img, 0, 0, width, height);
        // toBlob ensures better memory use and binary download
        canvas.toBlob((blob) => {
          if (!blob) {
            alert('Failed to create PNG blob');
            URL.revokeObjectURL(url);
            return;
          }
          const blobUrl = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = blobUrl;
          a.download = filename;
          document.body.appendChild(a);
          a.click();
          a.remove();
          URL.revokeObjectURL(blobUrl);
          URL.revokeObjectURL(url);
        }, 'image/png');
      };
      img.onerror = (e) => {
        URL.revokeObjectURL(url);
        alert('Failed to load SVG as image. Try opening this page in Chrome/Firefox.');
      };
      img.src = url;
    }

    // Download all in sequence
    function downloadAll() {
      downloadPNG('svg16', 16, 16, 'icon16.png');
      // small timeout so browser doesn't cancel downloads
      setTimeout(() => downloadPNG('svg48', 48, 48, 'icon48.png'), 300);
      setTimeout(() => downloadPNG('svg128', 128, 128, 'icon128.png'), 700);
    }
  </script>
</body>
</html>
