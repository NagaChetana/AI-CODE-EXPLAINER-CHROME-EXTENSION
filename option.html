<!DOCTYPE html>
<html>
<head>
  <title>CodePrompt Pro Settings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, sans-serif;
    }
    
    body {
      padding: 20px;
      max-width: 600px;
      margin: 0 auto;
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
      color: white;
      min-height: 100vh;
    }
    
    h1 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 2rem;
    }
    
    .section {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    
    h2 {
      margin-bottom: 15px;
      font-size: 1.3rem;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      font-size: 1rem;
    }
    
    input[type="text"], input[type="password"], select {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: none;
      margin-bottom: 15px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      font-size: 1rem;
    }
    
    button {
      background: #4285f4;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.3s;
      margin-right: 10px;
      margin-bottom: 10px;
      font-size: 1rem;
    }
    
    button:hover {
      background: #3367d6;
    }
    
    .status {
      margin-top: 15px;
      padding: 12px;
      border-radius: 8px;
      font-size: 0.95rem;
    }
    
    .success {
      background: rgba(76, 175, 80, 0.3);
    }
    
    .error {
      background: rgba(244, 67, 54, 0.3);
    }
    
    .warning {
      background: rgba(255, 193, 7, 0.3);
    }
    
    .api-info {
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
    }
    
    .back-link {
      display: block;
      text-align: center;
      margin-top: 30px;
      color: white;
      text-decoration: underline;
      background: none;
      border: none;
      padding: 0;
      font-size: 1rem;
      cursor: pointer;
      transition: opacity 0.3s;
    }
    
    .back-link:hover {
      background: none;
      opacity: 0.8;
    }
    
    .quota-info {
      background: rgba(255, 193, 7, 0.2);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    .key-steps {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    .key-steps ol {
      padding-left: 20px;
      margin-top: 10px;
    }
    
    .key-steps li {
      margin-bottom: 8px;
      line-height: 1.5;
    }
    
    .test-results {
      background: rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      font-family: monospace;
      white-space: pre-wrap;
      word-break: break-all;
      max-height: 300px;
      overflow-y: auto;
      font-size: 0.9rem;
    }
    
    .tab-container {
      display: flex;
      margin-bottom: 15px;
      border-radius: 8px;
      overflow: hidden;
      background: rgba(0, 0, 0, 0.2);
    }
    
    .tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.1);
      transition: background 0.3s;
      font-weight: 500;
    }
    
    .tab:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .tab.active {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .tab-content {
      display: none;
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 0 8px 8px 8px;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .alternative-solutions {
      margin-top: 15px;
    }
    
    .alternative-solutions h3 {
      margin-bottom: 10px;
      font-size: 1.1rem;
    }
    
    .alternative-solutions ol {
      padding-left: 20px;
    }
    
    .alternative-solutions li {
      margin-bottom: 8px;
      line-height: 1.5;
    }
    
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    a {
      color: #4fc3f7;
      text-decoration: underline;
    }
    
    @media (max-width: 600px) {
      body {
        padding: 15px;
      }
      
      h1 {
        font-size: 1.7rem;
      }
      
      .section {
        padding: 15px;
      }
      
      button {
        padding: 10px 15px;
        font-size: 0.9rem;
      }
      
      .tab {
        padding: 10px 5px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <h1>CodePrompt Pro Settings</h1>
  
  <div class="tab-container">
    <div class="tab active" data-tab="api">API Key</div>
    <div class="tab" data-tab="diagnostics">Diagnostics</div>
  </div>
  
  <div class="tab-content active" id="api-tab">
    <div class="section">
      <h2>API Configuration</h2>
      <div class="form-group">
        <label for="api-key">Gemini API Key:</label>
        <input type="password" id="api-key" placeholder="Enter your Gemini API key">
      </div>
      
      <div class="button-group">
        <button id="save-api-key">Save API Key</button>
        <button id="test-api-key">Test API Key</button>
      </div>
      
      <div id="api-status"></div>
      
      <div class="key-steps">
        <p><strong>How to get a working API key:</strong></p>
        <ol>
          <li>Go to <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
          <li>Sign in with your Google account</li>
          <li>Click "Create API Key in new project"</li>
          <li>Copy the API key and paste it above</li>
          <li>Click "Test API Key" to verify it works</li>
        </ol>
        <p><strong>Important:</strong> Always create a new project if keys aren't working!</p>
      </div>
      
      <div class="quota-info">
        <p><strong>Quota Information:</strong></p>
        <p>Free tier limits: 60 requests per minute, 1,000 requests per day</p>
        <p>If you see "quota completed" errors, you may need to:</p>
        <ul>
          <li>Create a new Google Cloud project (most reliable solution)</li>
          <li>Wait for the quota to reset (daily at midnight PT)</li>
          <li>Upgrade to a paid plan for higher limits</li>
        </ul>
      </div>
      
      <div class="api-info">
        <p><strong>Troubleshooting API Key Issues:</strong></p>
        <ul>
          <li>Make sure you're using the correct key (starts with "AIza")</li>
          <li>Ensure the Gemini API is enabled for your project</li>
          <li>Try creating a new project if existing keys don't work</li>
          <li>Check that your Google account has API access enabled</li>
          <li>Disable VPNs or proxies that might block the API</li>
        </ul>
      </div>
    </div>
    
    <div class="section">
      <h2>Extension Settings</h2>
      <div class="form-group">
        <label for="model-select">Gemini Model:</label>
        <select id="model-select">
          <option value="gemini-1.5-pro">Gemini 1.5 Pro (Recommended)</option>
          <option value="gemini-1.5-flash">Gemini 1.5 Flash (Faster)</option>
          <option value="gemini-1.0-pro">Gemini 1.0 Pro (Legacy)</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="max-tokens">Max Response Tokens:</label>
        <input type="text" id="max-tokens" value="1024">
      </div>
      
      <div class="form-group">
        <label for="temperature">Creativity (0.1-1.0):</label>
        <input type="text" id="temperature" value="0.7">
      </div>
      
      <button id="save-settings">Save Settings</button>
      <div id="settings-status"></div>
    </div>
  </div>
  
  <div class="tab-content" id="diagnostics-tab">
    <div class="section">
      <h2>API Diagnostics</h2>
      <button id="run-diagnostics">Run Diagnostics</button>
      <div id="diagnostics-results"></div>
    </div>
    
    <div class="section">
      <div class="alternative-solutions">
        <h3>Alternative Solutions</h3>
        <p>If you're still having issues with API keys, try these alternatives:</p>
        <ol>
          <li><strong>Use a different Google account</strong> - Some accounts may have restrictions</li>
          <li><strong>Try a different region</strong> - The API might not be available in your region</li>
          <li><strong>Use a different browser</strong> - Sometimes browser extensions can interfere</li>
          <li><strong>Clear browser cache</strong> - Old data might be causing issues</li>
          <li><strong>Try incognito mode</strong> - This rules out extension conflicts</li>
          <li><strong>Check your network</strong> - Corporate or school networks might block APIs</li>
        </ol>
      </div>
    </div>
  </div>
  
  <button id="close-options" class="back-link">Back to Extension</button>
  
  <script src="options.js"></script>
</body>
</html>